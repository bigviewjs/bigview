var _bigviewDebug=function(e,i){var t=(new Date).getTime(),r=function(){var e=(new Date).getTime();return"[+"+(e-t)+"ms];"},n=!1;return"undefined"!=typeof process?n=process.env._bigview:"undefined"!=typeof window&&(n=window.localStorage&&localStorage._bigview),function(e,i){n&&(e=e||"bigview",i=i||"",console.log("Module: "+e+"  "+i+"%c "+r(),"color: blue"))}}(),BigEvent=function(){};BigEvent.prototype.on=function(e,i){this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(i)},BigEvent.prototype.off=function(e,i){this._listeners=this._listeners||{},this._listeners[e].splice(this._listeners[e].indexOf(i),1)},BigEvent.prototype.trigger=function(e){this._listeners=this._listeners||{};for(var i=arguments[1]?arguments[1]:null,t=this._listeners[e]||[],r=0;r<t.length;r++){var n=t[r];i?n.call(this,i):n.call(this)}},BigEvent.extend=function(e){for(var i=["on","off","trigger"],t=0;t<i.length;t++){var r=i[t];"function"==typeof e?e.prototype[r]=BigEvent.prototype[r]:e[r]=BigEvent.prototype[r]}};var Bigview=function(){var e=this;this.log=function(e,i){_bigviewDebug(e,i)},this.view=function(i){e.trigger("pageletArrive",i),e.log(i.domid,"pageletArrive"),i.domid&&e.trigger(i.domid,i)},this.ready=function(i){this.log("ready"),e.trigger("ready",i)},this.end=function(i){this.log("end"),e.trigger("end",i)},this.error=function(i){this.log(i.domid,"error"),e.trigger("error",i)},this.beforePageletArrive=function(i){e.trigger("beforePageletArrive",i)},this.on("pageletArrive",function(i){if(i.error&&e.trigger("error",i),i.domid&&i.html&&e.replaceHtml(i.domid,i.html),i.css){var t=Array.isArray(i.css)?i.css:[i.css];t.forEach(function(i){e.insertCss(i)})}if(i.js){var r=Array.isArray(i.js)?i.js:[i.js];r.forEach(function(i){e.insertScript(i)})}}),this.replaceHtml=function(e,i){var t="string"==typeof e?document.getElementById(e):e;if(t){var r=t.cloneNode(!1);r.innerHTML=i.replace(/~~~~~~~/g,"<").replace(/=========/g,">"),t.parentNode.replaceChild(r,t);var n=r.getElementsByTagName("script");n=Array.prototype.slice.call(n);for(var s=n.length,o=0;s>o;o++){var l=n[o],a=document.createElement("SCRIPT");l.src?(a.src=l.src,l.parentNode.replaceChild(a,l)):l.innerText.trim()&&(a.text=l.innerText,l.parentNode.replaceChild(a,l))}return r}},this.insertCss=function(e){var i=document.createElement("link");i.rel="stylesheet",i.href=e,document.getElementsByTagName("head")[0].appendChild(i)},this.insertScript=function(e){var i=document.createElement("SCRIPT");i.src=e,document.body.appendChild(i)}};BigEvent.extend(Bigview);var _bigview=new Bigview;"function"==typeof define&&define.amd?define("bigview",[],function(){return _bigview}):"object"==typeof exports?module.exports=_bigview:window.bigview=_bigview;