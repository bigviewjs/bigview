var _bigviewDebug=function(e,t){var i=(new Date).getTime(),r=function(){var e=(new Date).getTime();return"[+"+(e-i)+"ms];"};return function(e,t){window.localStorage&&localStorage._bigview&&(e=e||"bigview",t=t||"",console.log("Module: "+e+"  "+t+"%c "+r(),"color: blue"))}}(),BigEvent=function(){};BigEvent.prototype.on=function(e,t){this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],this._listeners[e].push(t)},BigEvent.prototype.off=function(e,t){this._listeners=this._listeners||{},this._listeners[e].splice(this._listeners[e].indexOf(t),1)},BigEvent.prototype.trigger=function(e){this._listeners=this._listeners||{};for(var t=arguments[1]?arguments[1]:null,i=this._listeners[e]||[],r=0;r<i.length;r++){var n=i[r];t?n.call(this,t):n.call(this)}},BigEvent.extend=function(e){for(var t=["on","off","trigger"],i=0;i<t.length;i++){var r=t[i];"function"==typeof e?e.prototype[r]=BigEvent.prototype[r]:e[r]=BigEvent.prototype[r]}};var Bigview=function(){var e=this;this.log=function(e,t){_bigviewDebug(e,t)},this.view=function(t){e.trigger("pageletArrive",t),e.log(t.domid,"pageletArrive"),t.domid&&e.trigger(t.domid,t)},this.ready=function(t){this.log("ready"),e.trigger("ready",t)},this.end=function(t){this.log("end"),e.trigger("end",t)},this.error=function(t){this.log(t.domid,"error"),e.trigger("error",t)},this.beforePageletArrive=function(t){e.trigger("beforePageletArrive",t)},this.on("pageletArrive",function(t){if(t.error&&e.trigger("error",t),t.domid&&t.html&&e.replaceHtml(t.domid,t.html),t.css){var i=Array.isArray(t.css)?t.css:[t.css];i.forEach(function(t){e.insertCss(t)})}if(t.js){var r=Array.isArray(t.js)?t.js:[t.js];r.forEach(function(t){e.insertScript(t)})}}),this.replaceHtml=function(e,t){var i="string"==typeof e?document.getElementById(e):e;if(i){var r=i.cloneNode(!1);r.innerHTML=t.replace(/~~~~~~~/g,"<").replace(/=========/g,">"),i.parentNode.replaceChild(r,i);var n=r.getElementsByTagName("script");n=Array.prototype.slice.call(n);for(var o=n.length,s=0;o>s;s++){var l=n[s],a=document.createElement("SCRIPT");l.src?(a.src=l.src,l.parentNode.replaceChild(a,l)):l.innerText.trim()&&(a.text=l.innerText,l.parentNode.replaceChild(a,l))}return r}},this.insertCss=function(e){var t=document.createElement("link");t.rel="stylesheet",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)},this.insertScript=function(e){var t=document.createElement("SCRIPT");t.src=e,document.body.appendChild(t)}};BigEvent.extend(Bigview),window.bigview=new Bigview,"function"==typeof window.define&&window.define.amd&&window.define("bigview",[],function(){return window.bigview});
